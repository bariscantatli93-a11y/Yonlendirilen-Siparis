<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Düzce Lojistik Operasyon Merkezi</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        #map { height: 40vh; width: 100%; border-radius: 12px; border: 2px solid #ddd; margin-bottom: 16px; }
        .wa-btn { background: #25D366; color: white; padding: 10px 16px; border-radius: 10px; font-weight: bold; text-decoration: none; display: inline-block; }
        .wa-btn.disabled { background: #ccc; opacity: 0.6; pointer-events: none; }
        .card { background: white; border-radius: 12px; padding: 16px; margin-bottom: 16px; border-left: 5px solid #1e40af; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .status { padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .hazir { background: #fef3c7; color: #92400e; }
        .yolda { background: #fefce8; color: #854d0e; }
        .teslim { background: #dcfce7; color: #166534; }
    </style>
</head>
<body class="bg-slate-100 p-4">

    <h1 class="text-3xl font-black text-blue-900 mb-4 text-center">DÜZCE LOJİSTİK PANEL</h1>

    <div id="map" class="mb-6"></div>

    <div class="bg-white p-6 rounded-xl shadow mb-6 border-l-4 border-blue-600">
        <p class="text-sm text-gray-600">Toplam Hasılat (Pizza)</p>
        <p id="ciro" class="text-4xl font-bold text-blue-900">1845 TL</p>
    </div>

    <div id="kartlar"></div>

    <script>
        var map = L.map('map').setView([40.839, 31.158], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        var siparisler = [
            { id: 1001, adres: "Atatürk Cd. No:45", lat: 40.8385, lng: 31.1620, tutar: 285, musteri: "Ahmet", telefon: "+905551234567", kurye: "K1", durum: "Hazırlanıyor" },
            { id: 1002, adres: "İnönü Sk. 12", lat: 40.8420, lng: 31.1555, tutar: 420, musteri: "Ayşe", telefon: "+905559876543", kurye: "K2", durum: "Yolda" },
            { id: 1003, adres: "Cumhuriyet Blv.", lat: 40.8350, lng: 31.1700, tutar: 180, musteri: "Mehmet", telefon: "+905551112233", kurye: "K3", durum: "Teslim Edildi" },
            { id: 1004, adres: "19 Mayıs Sk.", lat: 40.8450, lng: 31.1480, tutar: 350, musteri: "Fatma", telefon: "+905551234567", kurye: "K1", durum: "Yolda" },
            { id: 1005, adres: "Sahil Yolu 8", lat: 40.8300, lng: 31.1750, tutar: 510, musteri: "Ali", telefon: "+905559876543", kurye: "K2", durum: "Hazırlanıyor" }
        ];

        var total = 0;
        siparisler.forEach(s => {
            total += s.tutar;

            var statusClass = '';
            if (s.durum === 'Hazırlanıyor') statusClass = 'hazir';
            else if (s.durum === 'Yolda') statusClass = 'yolda';
            else if (s.durum === 'Teslim Edildi') statusClass = 'teslim';

            var card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div class="flex justify-between mb-2">
                    <p class="font-bold text-lg">Sipariş #${s.id}</p>
                    <span class="status \( {statusClass}"> \){s.durum}</span>
                </div>
                <p class="text-sm mb-1"><strong>Adres:</strong> ${s.adres}</p>
                <p class="text-sm mb-1"><strong>Müşteri:</strong> ${s.musteri}</p>
                <p class="text-sm mb-3"><strong>Kurye:</strong> ${s.kurye} | ${s.tutar} TL</p>
                <a href="https://wa.me/\( {s.telefon}?text=Sipariş%20# \){s.id}%0AMüşteri:%20\( {encodeURIComponent(s.musteri)}%0ATutar:%20 \){s.tutar}%20TL%0AAdres:%20\( {encodeURIComponent(s.adres)}%0AKonum:%20https://www.google.com/maps?q= \){s.lat},${s.lng}" target="_blank" class="wa-btn ${s.durum === 'Teslim Edildi' ? 'disabled' : ''}">
                    WhatsApp Gönder
                </a>
            `;
            document.getElementById('kartlar').appendChild(card);

            var color = s.durum === 'Teslim Edildi' ? '#22c55e' : '#3b82f6';
            var marker = L.marker([s.lat, s.lng], {
                icon: L.divIcon({
                    html: `<div style="background:${color};width:20px;height:20px;border-radius:50%;border:3px solid white;"></div>`,
                    className: '',
                    iconSize: [20, 20],
                    iconAnchor: [10, 10]
                })
            }).addTo(map).bindPopup(`#${s.id} - \( {s.adres}<br> \){s.musteri} - \( {s.tutar} TL<br> \){s.kurye} - ${s.durum}`);
        });

        document.getElementById('ciro').innerText = total + ' TL';

        if (markers.length) map.fitBounds(L.featureGroup(markers).getBounds(), {padding: [40, 40]});
    </script>
</body>
</html>
