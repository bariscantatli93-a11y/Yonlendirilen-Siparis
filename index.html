<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Düzce Lojistik - Operasyon Paneli</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #f8fafc; }
        #map { height: 35vh; width: 100%; border-bottom: 2px solid #e2e8f0; }
        .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 700; text-transform: uppercase; }
        .hazir { background: #fef3c7; color: #92400e; }
        .yolda { background: #dbeafe; color: #1e40af; }
        .teslim { background: #dcfce7; color: #166534; }
        .btn-disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); pointer-events: none; }
    </style>
</head>
<body>

    <div class="bg-white p-4 shadow-sm flex justify-between items-center border-b-4 border-blue-600">
        <div>
            <h1 class="text-xl font-black text-blue-900 leading-none">DÜZCE LOJİSTİK</h1>
            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest">Kurye Takip Merkezi</p>
        </div>
        <div class="text-right">
            <p id="ciro" class="text-2xl font-black text-blue-600 leading-none">0 TL</p>
            <p class="text-[10px] font-bold text-slate-500 uppercase font-black">TOPLAM HASILAT</p>
        </div>
    </div>

    <div id="map"></div>

    <div class="p-4 max-w-5xl mx-auto">
        <h2 class="font-black text-slate-800 mb-4 flex items-center gap-2 text-lg">
            <span class="w-3 h-6 bg-blue-600 rounded-sm"></span> SİPARİŞ KONTROL PANELİ
        </h2>
        <div id="kartlar" class="space-y-3">
            </div>
    </div>

    <script>
        const SABIT_NUMARA = "905307938100"; 

        const siparisler = [
            { id: 1001, adres: "Atatürk Cd. No:45", lat: 40.8385, lng: 31.1620, tutar: 285, musteri: "Ahmet", kurye: "Kurye 1", durum: "Hazırlanıyor", odeme: "Nakit" },
            { id: 1002, adres: "İnönü Sk. 12", lat: 40.8420, lng: 31.1555, tutar: 420, musteri: "Ayşe", kurye: "Kurye 2", durum: "Yolda", odeme: "Kredi Kartı" },
            { id: 1003, adres: "Cumhuriyet Blv.", lat: 40.8350, lng: 31.1700, tutar: 180, musteri: "Mehmet", kurye: "Kurye 3", durum: "Teslim Edildi", odeme: "Online" },
            { id: 1004, adres: "19 Mayıs Sk.", lat: 40.8450, lng: 31.1480, tutar: 350, musteri: "Fatma", kurye: "Kurye 1", durum: "Yolda", odeme: "Nakit" },
            { id: 1005, adres: "Sahil Yolu 8", lat: 40.8300, lng: 31.1750, tutar: 510, musteri: "Ali", kurye: "Kurye 2", durum: "Hazırlanıyor", odeme: "Kredi Kartı" }
        ];

        let map = L.map('map').setView([40.839, 31.158], 13);
        L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png').addTo(map);

        function updateUI() {
            const container = document.getElementById('kartlar');
            container.innerHTML = '';
            let totalCiro = 0;

            siparisler.forEach(s => {
                totalCiro += s.tutar;
                const statusClass = s.durum === 'Hazırlanıyor' ? 'hazir' : (s.durum === 'Yolda' ? 'yolda' : 'teslim');
                
                // Sadece "Hazırlanıyor" ise buton aktif olsun
                const isBtnDisabled = s.durum !== 'Hazırlanıyor';

                // Yeni Mesaj Formatı
                const mesaj = `*Düzce Lojistik Bildirimi:*\n\n•Sipariş: #${s.id}\nKurye: ${s.kurye}\nTutar: ${s.tutar} TL / Ödeme: ${s.odeme}\n*Adres:* ${s.adres}\nMüşteri Konumu: https://www.google.com/maps?q=${s.lat},${s.lng}`;
                const waLink = `https://wa.me/${SABIT_NUMARA}?text=${encodeURIComponent(mesaj)}`;

                const card = `
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex justify-between items-center transition-all">
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <span class="font-black text-blue-900 text-lg">#${s.id}</span>
                                <span class="status-badge ${statusClass}">${s.durum}</span>
                            </div>
                            <p class="text-sm font-bold text-slate-700">${s.musteri} <span class="text-xs text-slate-400 font-normal">(${s.odeme})</span></p>
                            <p class="text-xs text-slate-500">${s.adres}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-black text-xl text-slate-800 mb-2">${s.tutar} TL</p>
                            <a href="${waLink}" target="_blank"
                               class="bg-emerald-500 text-white px-4 py-2 rounded-lg text-xs font-black uppercase hover:bg-emerald-600 flex items-center gap-2 ${isBtnDisabled ? 'btn-disabled' : ''}">
                               <svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981z"/></svg>
                               ${s.durum === 'Hazırlanıyor' ? 'BİLDİRİM GÖNDER' : 'GÖNDERİLDİ'}
                            </a>
                        </div>
                    </div>
                `;
                container.innerHTML += card;

                let markerColor = s.durum === 'Teslim Edildi' ? '#10b981' : (s.durum === 'Yolda' ? '#3b82f6' : '#f59e0b');
                L.circleMarker([s.lat, s.lng], { radius: 8, fillColor: markerColor, color: "#fff", weight: 3, fillOpacity: 1 }).addTo(map);
            });

            document.getElementById('ciro').innerText = totalCiro + ' TL';
        }

        updateUI();
    </script>
</body>
</html>
