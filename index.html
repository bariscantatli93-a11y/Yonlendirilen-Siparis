<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Düzce Lojistik Operasyon Merkezi</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f8fafc; }
        #map { height: 40vh; width: 100%; border-radius: 16px; border: 2px solid #e2e8f0; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .wa-btn { background: #25D366; color: white; padding: 10px 18px; border-radius: 10px; font-weight: 600; font-size: 14px; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; transition: background 0.2s; }
        .wa-btn:hover { background: #1da851; }
        .wa-btn.disabled { background: #cbd5e1; cursor: not-allowed; opacity: 0.7; pointer-events: none; }
        .card { background: white; border-radius: 16px; padding: 16px; margin-bottom: 16px; border-left: 5px solid #3b82f6; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: transform 0.2s; }
        .card:hover { transform: translateY(-4px); }
        .status { padding: 4px 12px; border-radius: 999px; font-size: 12px; font-weight: bold; }
        .hazir { background: #fef3c7; color: #92400e; }
        .yolda { background: #fefce8; color: #854d0e; }
        .teslim { background: #dcfce7; color: #166534; }
        h1 { font-size: 1.8rem; font-weight: 900; color: #1e40af; text-align: center; margin-bottom: 16px; }
    </style>
</head>
<body>

    <h1>DÜZCE LOJİSTİK OPERASYON MERKEZİ</h1>

    <div id="map"></div>

    <div class="bg-white p-6 rounded-2xl shadow-lg mb-6 border-l-4 border-blue-600 mx-4">
        <p class="text-sm font-bold text-slate-600 uppercase tracking-wide">Toplam Hasılat (Pizza Şubesi)</p>
        <p id="ciro" class="text-4xl font-black text-blue-900 mt-1">1745 TL</p>
    </div>

    <div id="kartlar" class="px-4"></div>

    <script>
        var map = L.map('map').setView([40.839, 31.158], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        var siparisler = [
            { id: 1001, adres: "Atatürk Cd. No:45", lat: 40.8385, lng: 31.1620, tutar: 285, musteri: "Ahmet", telefon: "+905551234567", kurye: "K1", durum: "Hazırlanıyor" },
            { id: 1002, adres: "İnönü Sk. 12", lat: 40.8420, lng: 31.1555, tutar: 420, musteri: "Ayşe", telefon: "+905559876543", kurye: "K2", durum: "Yolda" },
            { id: 1003, adres: "Cumhuriyet Blv.", lat: 40.8350, lng: 31.1700, tutar: 180, musteri: "Mehmet", telefon: "+905551112233", kurye: "K3", durum: "Teslim Edildi" },
            { id: 1004, adres: "19 Mayıs Sk.", lat: 40.8450, lng: 31.1480, tutar: 350, musteri: "Fatma", telefon: "+905551234567", kurye: "K1", durum: "Yolda" },
            { id: 1005, adres: "Sahil Yolu 8", lat: 40.8300, lng: 31.1750, tutar: 510, musteri: "Ali", telefon: "+905559876543", kurye: "K2", durum: "Hazırlanıyor" }
        ];

        var total = 0;
        var markers = [];

        siparisler.forEach(s => {
            total += s.tutar;

            var statusClass = '';
            if (s.durum === 'Hazırlanıyor') statusClass = 'hazir';
            else if (s.durum === 'Yolda') statusClass = 'yolda';
            else if (s.durum === 'Teslim Edildi') statusClass = 'teslim';

            var card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <p class="font-bold text-lg text-blue-900">Sipariş #${s.id}</p>
                    <span class="status \( {statusClass}"> \){s.durum}</span>
                </div>
                <p class="text-sm mb-2"><strong>Adres:</strong> ${s.adres}</p>
                <p class="text-sm mb-2"><strong>Müşteri:</strong> ${s.musteri}</p>
                <p class="text-sm mb-3"><strong>Kurye:</strong> \( {s.kurye} | <strong> \){s.tutar} TL</strong></p>
                <a href="https://wa.me/\( {s.telefon}?text= \){encodeURIComponent(`Yeni Sipariş #${s.id}\nMüşteri: ${s.musteri}\nTutar: ${s.tutar} TL\nAdres: \( {s.adres}\nKonum: https://www.google.com/maps?q= \){s.lat},${s.lng}`)}" target="_blank" class="wa-btn ${s.durum === 'Teslim Edildi' ? 'disabled' : ''}">
                    WhatsApp Gönder
                </a>
            `;
            document.getElementById('kartlar').appendChild(card);

            var color = s.durum === 'Teslim Edildi' ? '#22c55e' : '#3b82f6';
            var marker = L.marker([s.lat, s.lng], {
                icon: L.divIcon({
                    html: `<div style="background:${color};width:24px;height:24px;border-radius:50%;border:3px solid white;box-shadow:0 2px 6px rgba(0,0,0,0.3);"></div>`,
                    className: '',
                    iconSize: [24, 24],
                    iconAnchor: [12, 12]
                })
            }).addTo(map).bindPopup(`<b>Sipariş #\( {s.id}</b><br> \){s.adres}<br>Müşteri: ${s.musteri}<br>Tutar: ${s.tutar} TL<br>Kurye: ${s.kurye}<br>Durum: ${s.durum}`);
            markers.push(marker);
        });

        document.getElementById('ciro').innerText = total + ' TL';

        if (markers.length) map.fitBounds(L.featureGroup(markers).getBounds(), {padding: [40, 40]});
    </script>
</body>
</html>
